個人開発のサービスから、ここ数ヶ月で5件、延べ1万件近い個人情報漏洩を発見・報告してきました。その中で規則性を見つけたため、「Supabase RLS Checker」というChrome拡張機能を作成しました。

※このツール自体は法律的にグレーな部分があるため、ストアで一般公開するかは検討中ですが、コードは公開しています。
→ https://github.com/hand-dot/supabase-rls-checker
※リスクを理解せずに利用するのは推奨しません。最悪の場合、訴訟リスクもありますのでご注意ください。

もしストアで公開した際は改めてお知らせします。Supabaseを使ってサービスを開発している方は、誰かに個人情報を抜かれる前にぜひ一度試してみてください。このツールは、クライアントに漏れているanon keyをリアルタイムで検知できます。

なお、下記のようなアイデアから本ツールを開発しました。

1. PII（個人情報）を含むテーブルにRLS（Row Level Security）が未設定、または設定が不十分なサイトが多い
2. anon keyはリクエストインターセプターを作ればリアルタイムで取得可能
3. PIIを含む可能性が高いテーブル名はネット上に多く存在する
4. リクエストを送り、データが30件以上返ってくる場合、auth.uid() = user_id のようなポリシーが設定されていない可能性が高い
5. supabaseのplaygroundを用意し、上記のanon keyとともにリクエストを送信、データ内容を確認しPIIであれば運営者に報告する

実際、vibecodingで一日で作られたようなサイトのanon key経由で、書き込みができてしまったこともありました。
（※このような状況は非常に危険です。個人情報がリスト化され、売買されている可能性もあります。）

自戒も込めてですが、サービスを安心して使ってもらうためにも、設定を今一度見直しましょう。
「きっと誰かがユーザーの情報を抜いている」かもしれません。

https://github.com/hand-dot/supabase-rls-checker

